version: '3.8'

services:
  stock-valuation-mcp:
    build: .
    container_name: stock-valuation-server
    restart: unless-stopped
    environment:
      - NODE_ENV=production
      - LOG_LEVEL=info
      - SET_WATCH_API_HOST=https://set-watch-api.vercel.app
      - SET_WATCH_API_TIMEOUT=30000
    ports:
      - "2901:2901"
    volumes:
      - ./dist:/app/dist
      - ./src:/app/src
    networks:
      - mcp-net

  mcp-inspector:
    image: node:18-alpine
    container_name: mcp-inspector
    depends_on:
      - stock-valuation-mcp
    ports:
      - "3000:3000"
    volumes:
      - ./:/app
    working_dir: /app
    command: sh -c "npm install -g @modelcontextprotocol/inspector && npx @modelcontextprotocol/inspector node dist/index.js"
    networks:
      - mcp-net

networks:
  mcp-net:
    driver: bridge